@page "/wizard"
@layout AuthenticatedLayout
@inject ISnackbar Snackbar
@using MudExtensions
@using MudBlazor.Extensions
@using MudExtensions.Utilities

<MudGrid Class="cursor-default">
    <MudItem xs="12" sm="8" Class="d-flex align-center">
        <MudStepperExtended Class="mud-width-full" ContentStyle="min-height: 400px" Linear="_linear" Vertical="_vertical" Color="_color" Variant="_variant"
                            Animation="_animation" ShowPreviousButton="_showPreviousButton" ShowNextButton="_showNextButton"
                            ShowSkipButton="_showSkipButton" ShowStepResultIndicator="_showStepResultIndicator" HeaderBadgeView="HeaderBadgeView.All"
                            HeaderTextView="HeaderTextView.All" LocalizedStrings="GetLocalizedStrings()" IconActionButtons="_iconActionButtons" HeaderSize="_headerSize"
                            StepperActionsJustify="StepperActionsJustify.SpaceBetween">
            <StaticContent>
                <MudStack Row="true" AlignItems="AlignItems.Center">
                    <MudAvatar Color="_color">ST</MudAvatar>
                    <MudText>This is a static content which shows with each step.</MudText>
                </MudStack>
            </StaticContent>
            <ChildContent>
                <MudStepExtended Icon="@Icons.Material.Filled.Approval" Title="Customer Info" StatusChanged="StatusChanged">
                    <ChildContent>
                        <MudForm @ref="_form">
                            <MudStack>
                                <MudTextField T="string" Label="Name" Variant="_variant" Required="true"/>
                                <MudTextField T="string" Label="Last Name" Variant="_variant"/>
                                <MudTextField T="string" Label="Adress" Variant="_variant"/>
                            </MudStack>
                        </MudForm>
                    </ChildContent>
                </MudStepExtended>
                <MudStepExtended Title="Booking Spec." Icon="@Icons.Material.Filled.MoreVert" Optional="true">
                    <ChildContent>
                        <MudCheckBox T="bool" Label="Early Check-in" Color="_color"/>
                        <MudCheckBox T="bool" Label="Late Check-out" Color="_color"/>
                        <MudCheckBox T="bool" Label="Twin Bed" Color="_color"/>
                    </ChildContent>
                </MudStepExtended>
                <MudStepExtended Icon="@Icons.Material.Filled.Money" Title="Payment">
                    <ChildContent>
                        <MudForm @ref="_form2">
                            <MudStack>
                                <MudTextField T="string" Label="Card Number" Variant="_variant" Required="true"/>
                                <MudStack Row="true">
                                    <MudTextField T="string" Label="Expire Date" Variant="_variant" Required="true"/>
                                    <MudTextField T="string" Label="CVC" Variant="_variant" Required="true"/>
                                </MudStack>
                            </MudStack>
                        </MudForm>
                    </ChildContent>
                </MudStepExtended>

                @if (_addResultStep)
                {
                    <MudStepExtended Icon="@Icons.Material.Filled.Alarm" Title="Result Step" IsResultStep="true">
                        <ChildContent>
                            <div class="d-flex flex-column align-center justify-center" style="height: 200px">
                                <MudIconButton Icon="@Icons.Material.Filled.DoneAll" Size="Size.Large" Variant="Variant.Filled" Color="Color.Success"/>
                                <MudText>Your reservation successfully completed.</MudText>
                            </div>
                        </ChildContent>
                    </MudStepExtended>
                }
            </ChildContent>
            <ActionContent>
                @* <MudSpacer /> *@
            </ActionContent>
        </MudStepperExtended>
    </MudItem>
</MudGrid>

@code {
    MudForm? _form = new();
    MudForm? _form2 = new();
    bool _checkValidationBeforeComplete = false;
    bool _linear;
    bool _mobileView;
    bool _iconActionButtons;
    Variant _variant = Variant.Filled;
    bool _animation = true;
    bool _showPreviousButton = true;
    bool _showNextButton = true;
    bool _showSkipButton = true;
    bool _showStepResultIndicator = true;
    bool _addResultStep = true;
    bool _customLocalization = false;
    Color _color = Color.Primary;
    int _activeIndex = 0;
    bool _loading;
    bool _showStaticContent = false;
    bool _showCustomButton = false;
    bool _vertical = false;
    Size _headerSize = Size.Medium;


    private void StatusChanged(StepStatus status)
    {
        Snackbar.Add($"First step {status.ToDescriptionString()}.", Severity.Info);
    }

    private StepperLocalizedStrings GetLocalizedStrings()
    {
        if (_customLocalization == false)
        {
            return new StepperLocalizedStrings();
        }
        else
        {
            return new StepperLocalizedStrings()
            {
                Completed = "Abgeschlossen",
                Finish = "Fertig",
                Next = "Nächste",
                Optional = "Optional",
                Previous = "Früher",
                Skip = "überspringen",
                Skipped = "übersprungen",
            };
        }
    }

}
